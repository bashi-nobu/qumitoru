FROM python:3.7
ENV PYTHONUNBUFFERED 1

ENV APP_ROOT /api
WORKDIR $APP_ROOT

ARG AWS_ACCESS_KEY_ID
ARG AWS_SECRET_ACCESS_KEY
ARG BUCKET_NAME
ARG DJANGO_SECRET_KEY
ARG IMAGE_SCAN_API_URL

ENV AWS_ACCESS_KEY_ID ${AWS_ACCESS_KEY_ID}
ENV AWS_SECRET_ACCESS_KEY ${AWS_SECRET_ACCESS_KEY}
ENV BUCKET_NAME ${BUCKET_NAME}
ENV DJANGO_SECRET_KEY ${DJANGO_SECRET_KEY}
ENV IMAGE_SCAN_API_URL ${IMAGE_SCAN_API_URL}

COPY ./docker/django/requirements.txt $APP_ROOT/requirements.txt
RUN pip install -r $APP_ROOT/requirements.txt

COPY ./django/qumitoru $APP_ROOT
